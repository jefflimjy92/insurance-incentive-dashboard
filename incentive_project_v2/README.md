# 💰 보험 설계사 인센티브 대시보드

보험 설계사의 개인시상(인센티브) 수익을 자동 계산하고 전략적 조언을 제공하는 웹 대시보드입니다.

## ✨ 주요 기능

- 📊 **4가지 시상 유형 자동 계산**
  - 정률형: 실적 × 지급률(%)
  - 계단형: 실적 구간별 고정 보상 (내림 처리)
  - 연속형: 4주 연속 달성 시 보상
  - 합산형: 전체 기간 합산 실적 기준

- 🔄 **경쟁 시상 자동 처리**: 같은 그룹 내 최고 금액 자동 선택

- ⚠️ **놓친 기회 분석**: 달성률 80-99% 시상 중 ROI 높은 것 추천

- 💡 **전략 전환 시점 분석**: 효율 급감 시점 탐지

- 📈 **시각화**: 일별 추이 차트, 상품별 통계

## 🚀 시작하기

### 1. 패키지 설치

```bash
cd insurance-incentive-dashboard
pip install -r requirements.txt
```

### 2. Google Cloud 설정

1. [Google Cloud Console](https://console.cloud.google.com/)에서 프로젝트 생성
2. Google Sheets API 활성화
3. Service Account 생성 및 JSON 키 다운로드
4. 스프레드시트에 Service Account 이메일 공유 (뷰어 이상)

### 3. 스프레드시트 준비

#### 계약데이터 시트

| 컬럼명 | 설명 | 예시 |
|--------|------|------|
| 접수일 | 계약 접수 날짜 (YYYY-MM-DD) | 2025-10-15 |
| 사원명 | 설계사 이름 | 김균언 |
| 모집인명 | 실제 모집한 사람 | 김균언 |
| 계약자 | 계약 체결 고객 | 홍길동 |
| 상품명 | 보험 상품명 | 실손의료비 |
| 상품종류 | 보장성/재물성/단체 | 보장성 |
| 보험료 | 월납금액 (원) | 50000 |

#### 시상규칙 시트

| 컬럼명 | 설명 | 예시 |
|--------|------|------|
| 회사 | 보험사명 | KB손해보험 |
| 시상명 | 시상 이름 | 월간실적정률 |
| 유형 | 정률형/계단형/연속형/합산형 | 정률형 |
| 포함상품 | 특정 상품만 인정 (파이프 구분) | 새로고침\|내돈내삼 |
| 비교시상 | 경쟁 그룹 ID | 1주차그룹 |
| 1단계목표 ~ 9단계목표 | 단계별 목표 금액 | 50000 |
| 1단계보상 ~ 9단계보상 | 단계별 보상 금액 | 30000 |
| 지급률 | 정률형 전용 (%) | 10 |

### 4. 앱 실행

```bash
streamlit run streamlit_app.py
```

브라우저에서 `http://localhost:8501` 접속

## 📁 파일 구조

```
insurance-incentive-dashboard/
├── streamlit_app.py     # 메인 UI
├── data_loader.py       # 데이터 로드 및 전처리
├── incentive_engine.py  # 계산 엔진
├── analysis.py          # 분석 기능
├── requirements.txt     # Python 패키지
└── README.md            # 이 파일
```

## 🧮 계산 로직

### 정률형
```
지급금액 = 실적 × (지급률 / 100)
```

### 계단형 (내림 처리)
```
달성단계 = 실적 >= N단계목표 인 최대 N
지급금액 = 달성단계보상
```

### 연속형 (4주 연속)
```
연속달성단계 = MIN(각 주차별 달성단계)
지급금액 = 연속달성단계보상 (모두 0이면 0원)
```

### 합산형
```
전체기간 실적 합산 후 계단형과 동일
```

### 경쟁 시상
```
같은 비교시상 그룹 내 최대 지급금액만 선택
```

## ⚠️ 전처리 규칙

1. **본인 계약 제외**: `모집인명 == 계약자` 인 경우 제외
2. **상품 자동 분류** (우선순위):
   - 펫보험: 상품명에 '펫' 포함
   - 단체보험: 상품종류 = '단체'
   - 재물보험: 상품종류 = '재물성'
   - 인보험: 상품종류 = '보장성'

## 📞 문의

문제가 있으시면 이슈를 등록해주세요.
